@model TotalInvoiceViewModel

<div class="container py-4">
    <div class="card shadow-lg p-4 rounded-4">
        <h3 class="text-primary mb-4">Hóa đơn cuộc hẹn</h3>

        <div class="mb-4">
            <p><strong>Bệnh nhân:</strong> @Model.Appointment.Patient?.FullName</p>
            <p><strong>Ngày khám:</strong> @Model.Appointment.Date.ToString("dd/MM/yyyy")</p>
        </div>

        <div class="table-responsive mb-4">
            <table class="table table-hover table-bordered align-middle text-center">
                <thead class="table-light">
                    <tr>
                        <th class="text-uppercase">Xét nghiệm</th>
                        <th class="text-uppercase">Trạng thái</th>
                        <th class="text-uppercase">Giờ thực hiện</th>
                        <th class="text-uppercase">Giá</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Items)
                    {
                        var status = item.Status ?? "Không xác định";
                        var statusText = status switch
                        {
                            "Paid" => "Đã thanh toán",
                            "Unpaid" => "Chưa thanh toán",
                            _ => status
                        };
                        var badgeClass = status switch
                        {
                            "Paid" => "bg-success",
                            "Unpaid" => "bg-warning text-dark",
                            _ => "bg-secondary"
                        };

                        <tr>
                            <td>@item.TestName</td>
                            <td>
                                <span class="badge @badgeClass px-3 py-2 rounded-pill">@statusText</span>
                            </td>
                            <td>@item.CompletedAt?.ToString("dd/MM/yyyy HH:mm:ss")</td>
                            <td class="text-success fw-bold">@($"{item.Amount:#,##0}₫")</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="text-end">
            <h5>Tổng cộng:
                <strong class="text-primary">@($"{Model.Items.Sum(x => x.Amount):#,##0}₫")</strong>
            </h5>
        </div>
    </div>
</div>
