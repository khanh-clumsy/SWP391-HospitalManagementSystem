@* @model List<MedicalPackage> *@
@section Styles {
	<style>
		/* Filter Section */
		.filter-section {
			background: #f8f9fa;
			padding: 2rem;
			border-radius: 10px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		}

			.filter-section .form-select {
				border: 1px solid #ddd;
				border-radius: 5px;
				padding: 0.6rem 1rem;
				font-size: 0.9rem;
			}

				.filter-section .form-select:focus {
					border-color: #007bff;
					box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
				}

		/* Package Cards */
		.package-card {
			background: white;
			border-radius: 12px;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			overflow: hidden;
			transition: all 0.3s ease;
			height: 100%;
		}

			.package-card:hover {
				transform: translateY(-5px);
				box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
			}

		/* Discount Badge */
		.discount-badge {
			position: absolute;
			top: 15px;
			left: 15px;
			background: #ff6b6b;
			color: white;
			padding: 5px 12px;
			border-radius: 20px;
			font-size: 0.85rem;
			font-weight: 600;
			z-index: 2;
		}

		/* Package Image */
		.package-image {
			height: 200px;
			overflow: hidden;
			position: relative;
		}

			.package-image img {
				width: 100%;
				height: 100%;
				object-fit: cover;
				transition: transform 0.3s ease;
			}

		.package-card:hover .package-image img {
			transform: scale(1.05);
		}

		/* Package Content */
		.package-content {
			padding: 1.5rem;
		}

		.package-price {
			margin-bottom: 1rem;
		}

		.original-price {
			color: #999;
			text-decoration: line-through;
			font-size: 0.9rem;
			margin-right: 0.5rem;
		}

		.current-price {
			color: #007bff;
			font-size: 1.25rem;
			font-weight: bold;
		}

		.package-title {
			color: #333;
			font-size: 1.1rem;
			font-weight: 600;
			margin-bottom: 1rem;
			line-height: 1.3;
			min-height: 2.6rem;
		}

		.package-info {
			margin-bottom: 1rem;
		}

		.info-item {
			display: flex;
			align-items: center;
			margin-bottom: 0.5rem;
			font-size: 0.9rem;
			color: #666;
		}

			.info-item:last-child {
				margin-bottom: 0;
			}

			.info-item i {
				width: 16px;
				text-align: center;
			}

		/* Package Actions */
		.package-actions {
			display: flex;
			gap: 0.5rem;
			flex-wrap: wrap;
		}

			.package-actions .btn {
				flex: 1;
				min-width: 110px;
				font-size: 0.85rem;
				padding: 0.5rem 0.75rem;
				border-radius: 6px;
				transition: all 0.2s ease;
			}

				.package-actions .btn:hover {
					transform: translateY(-2px);
				}

		/* Button styles */
		.btn-primary {
			background: linear-gradient(45deg, #007bff, #0056b3);
			border: none;
		}

			.btn-primary:hover {
				background: linear-gradient(45deg, #0056b3, #004085);
			}

		.btn-success {
			background: linear-gradient(45deg, #28a745, #1e7e34);
			border: none;
		}

			.btn-success:hover {
				background: linear-gradient(45deg, #1e7e34, #155724);
			}
	</style>
}

<div class="container-fluid page-header py-5 mb-5 wow fadeIn" data-wow-delay="0.1s">
	<div class="container py-5">
		<h1 class="display-3 text-white mb-3 animated slideInDown">Gói Khám Sức Khỏe</h1>
		<nav aria-label="breadcrumb animated slideInDown">
			<ol class="breadcrumb text-uppercase mb-0">
				<li class="breadcrumb-item"><a class="text-white" href="#">Trang chủ</a></li>
				<li class="breadcrumb-item text-primary active" aria-current="page">Gói khám</li>
			</ol>
		</nav>
	</div>
</div>

<div class="container-xxl py-5">
	<div class="container">
		<div class="mb-4 d-flex justify-content-between align-items-center">
			<h2 class="text-primary">Danh Sách Gói Khám</h2>
			@if (User.IsInRole("Admin"))
			{
				<a asp-controller="MedicalPackage" asp-action="Create" class="btn btn-primary btn-lg">
					<i class="fas fa-plus me-2"></i>Thêm Gói Khám Mới
				</a>
			}
		</div>

		<!-- Filter Form -->
		<form method="get" asp-action="Filter" asp-controller="MedicalPackage" class="filter-section mb-5">
			<div class="row g-3">
				<div class="col-lg-2 col-md-4">
					<select name="CategoryFilter" asp-items="ViewBag.Categories" class="form-select">
						<option value="">Chọn danh mục khám</option>
					</select>
				</div>

				<div class="col-lg-2 col-md-4">
					<select name="ProvinceFilter" asp-items="ViewBag.Provinces" class="form-select">
						<option value="">Chọn tỉnh/thành phố</option>
					</select>
				</div>

				<div class="col-lg-2 col-md-4">
					<select name="AgeFilter" class="form-select">
						<option value="">Chọn độ tuổi</option>
						<option value="18-30">18 - 30 tuổi</option>
						<option value="31-45">31 - 45 tuổi</option>
						<option value="46-60">46 - 60 tuổi</option>
						<option value="60+">Trên 60 tuổi</option>
					</select>
				</div>

				<div class="col-lg-2 col-md-4">
					<select name="PriceRangeFilter" class="form-select">
						<option value="">Chọn khoảng giá gói khám</option>
						<option value="0-1000000">Dưới 1 triệu</option>
						<option value="1000000-5000000">1 - 5 triệu</option>
						<option value="5000000-10000000">5 - 10 triệu</option>
						<option value="10000000+">Trên 10 triệu</option>
					</select>
				</div>

				<div class="col-lg-2 col-md-4">
					<button type="submit" class="btn btn-primary w-100">
						<i class="fas fa-search me-1"></i> Tìm kiếm
					</button>
				</div>

				<div class="col-lg-2 col-md-4">
					<a href="@Url.Action("Index", "MedicalPackage")" class="btn btn-outline-secondary w-100">
						<i class="fas fa-times me-1"></i> Bỏ lọc
					</a>
				</div>
			</div>
		</form>

		<!-- Medical Package Cards -->
		<div class="row g-4">
			@if (Model != null && Model.Any())
			{
				foreach (var package in Model)
				{
					<div class="col-lg-4 col-md-6 col-12">
						<div class="package-card position-relative">
							<!-- Discount Badge -->
							@if (package.DiscountPercent > 0)
							{
								<div class="discount-badge">
									- @package.DiscountPercent%
								</div>
							}

							<div class="package-image">
								<img src="@(package.Image != null ? $"data:image/png;base64,{package.Image}" : Url.Content("~/img/medical-default.jpg"))"
									 alt="@package.Name"
									 class="w-100 h-100" />
							</div>

							<div class="package-content">
								<div class="package-price">
									@if (package.OriginalPrice > package.CurrentPrice)
									{
										<span class="original-price">@package.OriginalPrice.ToString("N0") đ</span>
									}
									<span class="current-price">@package.CurrentPrice.ToString("N0") đ</span>
								</div>

								<h5 class="package-title">@package.Name</h5>

								<div class="package-info">
									<div class="info-item">
										<i class="fas fa-venus-mars text-primary me-2"></i>
										<span>@package.TargetGender</span>
									</div>
									<div class="info-item">
										<i class="fas fa-calendar-alt text-primary me-2"></i>
										<span>@package.AgeRange</span>
									</div>
									<div class="info-item">
										<i class="fas fa-map-marker-alt text-primary me-2"></i>
										<span>@package.Location</span>
									</div>
								</div>

								<div class="package-actions mt-3">
									@if (User.IsInRole("Admin"))
									{
										<a asp-action="Edit" asp-controller="MedicalPackage" asp-route-id="@package.Id"
										   class="btn btn-outline-primary btn-sm">
											<i class="fas fa-edit me-1"></i>Chỉnh sửa
										</a>
										<form asp-action="Delete" asp-controller="MedicalPackage" asp-route-id="@package.Id"
											  method="post" onsubmit="return confirm('Bạn có chắc chắn muốn xóa gói khám này?');"
											  class="d-inline">
											<button type="submit" class="btn btn-outline-danger btn-sm">
												<i class="fas fa-trash me-1"></i>Xóa
											</button>
										</form>
									}
									else
									{
										<a asp-action="Details" asp-controller="MedicalPackage" asp-route-id="@package.Id"
										   class="btn btn-primary btn-sm">
											<i class="fas fa-eye me-1"></i>Xem chi tiết
										</a>
										<a asp-action="Book" asp-controller="MedicalPackage" asp-route-id="@package.Id"
										   class="btn btn-success btn-sm">
											<i class="fas fa-calendar-plus me-1"></i>Đặt khám
										</a>
									}
								</div>
							</div>
						</div>
					</div>
				}
			}
			else
			{
				<div class="col-12">
					<div class="text-center py-5">
						<i class="fas fa-heart-pulse fa-5x text-muted mb-3"></i>
						<h4 class="text-muted">Không tìm thấy gói khám nào</h4>
						<p class="text-muted">Thử điều chỉnh tiêu chí tìm kiếm hoặc thêm gói khám mới.</p>
						@if (User.IsInRole("Admin"))
						{
							<a asp-controller="MedicalPackage" asp-action="Create" class="btn btn-primary btn-lg">
								<i class="fas fa-plus me-2"></i>Thêm Gói Khám Đầu Tiên
							</a>
						}
					</div>
				</div>
			}
		</div>
	</div>
</div>

<a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>

